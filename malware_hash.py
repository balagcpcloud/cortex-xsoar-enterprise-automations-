def main():
    args = demisto.args()

    hostname = args.get("hostname")
    file_hash = args.get("file_hash")
    business_service = args.get("business_service", "Business-App-3")

    vt = demisto.executeCommand(
        "vt-get-file-report",
        {"file": file_hash}
    )

    if not vt:
        demisto.results("Hash not malicious")
        return

    demisto.executeCommand(
        "servicenow-create",
        {
            "short_description": "Malware detected on server",
            "severity": "High",
            "comments": f"""
Business Service: {business_service}
Hostname: {hostname}
File Hash: {file_hash}
Threat Intel: VirusTotal
"""
        }
    )

    demisto.results("Malware incident created")

if __name__ in ("__main__", "builtin", "builtins"):
    main()
